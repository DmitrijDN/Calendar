@using System.Text

@using Bs.Calendar.Models
@using Bs.Calendar.Rules
@model Bs.Calendar.Mvc.ViewModels.UsersVm

<input id="listPage" hidden="true" value="@Model.PagingVm.Page">
<input id="listTotalPages" hidden="true" value="@Model.PagingVm.TotalPages">
<input id="listSearchStr" hidden="true" value="@Model.PagingVm.SearchStr">
<input id="listSortByStr" hidden="true" value="@Model.PagingVm.SortByStr">
@foreach (var user in Model.Users)
{
    bool notApproved = user.ApproveState == ApproveStates.NotApproved;

    var labelText = new StringBuilder(user.Live.GetDescription());
    labelText.AppendFormat(", {0}", user.ApproveState.GetDescription().ToLower());
    
    string notApprovedStyle = notApproved ? "background-color: Yellow" : null;
    
    <tr ondblclick="RowDblClick('@Url.Action("Edit", "Users", new { id = user.Id })')" style="@notApprovedStyle">
        <td>
            <label for="name">@labelText</label>
        </td>
        <td id="name">@user.FirstName @user.LastName</td>
        <td>@user.Email</td>
        <td>
            <div class="default btn">@Html.ActionLink("Edit", "Edit", new { id = user.Id })</div>
        </td>
    </tr>
}

